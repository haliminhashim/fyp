{"version":3,"sources":["../../src/pages/checkout/checkout.module.ts","../../src/pages/checkout/checkout.ts"],"names":[],"mappings":"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","file":"11.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { CheckoutPage } from './checkout';\n\n@NgModule({\n  declarations: [\n    CheckoutPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(CheckoutPage),\n  ]\n})\nexport class CheckoutPageModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/checkout/checkout.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ViewController, ModalController } from 'ionic-angular';\nimport { UsersProvider } from '../../providers/users/users';\nimport { AddressesProvider } from '../../providers/addresses/addresses';\nimport { OrdersProvider } from '../../providers/orders/orders';\nimport { CartsProvider } from '../../providers/carts/carts';\n\n@IonicPage()\n@Component({\n  selector: 'page-checkout',\n  templateUrl: 'checkout.html',\n})\nexport class CheckoutPage {\n  paymentdata: any;\n  paymentdetails: any;\n  checkoutList: any[] = [];\n  payment: any = \"paypal\";\n  delivery: any;\n  subTotalAmnt: number = 0.00;\n  shippingAmnt: number = 1.00;\n  totalAmnt: number = 0.00;\n  shippingAddress: any = { id: null };\n  billingAddress: any = { id: null };\n  user: any = this.usersProvider.currentUser();\n  deliveryOption: any = [{\n    id: 1,\n    name: \"Standard\",\n    price: 1.00,\n  }, {\n    id: 2,\n    name: \"Express\",\n    price: 3.00,\n  }];;\n\n  constructor(public navCtrl: NavController, public cartsProvider: CartsProvider, public ordersProvider: OrdersProvider, public navParams: NavParams, public addressesProvider: AddressesProvider, public usersProvider: UsersProvider, public viewCtrl: ViewController, public modalCtrl: ModalController) {\n\n\n\n    this.delivery = 0\n    this.payment = \"paypal\";\n    this.shippingAmnt = 1;\n    this.checkoutList = this.navParams.get('items');\n    this.subTotalAmnt = this.navParams.get('subTotal');\n    this.totalAmnt = this.subTotalAmnt + this.shippingAmnt;\n    this.setAddresses();\n  }\n\n  calculateTotal() {\n    this.shippingAmnt = this.deliveryOption[this.delivery].price\n    this.totalAmnt = +this.subTotalAmnt + +this.shippingAmnt;\n  }\n\n  closeModal() {\n    this.viewCtrl.dismiss();\n  }\n\n  setAddresses() {\n    let billingId = this.user.defaultBillingAddress;\n    let shippingId = this.user.defaultShippingAddress;\n    if (billingId != null) {\n      this.addressesProvider.getAddress(billingId).then(data => {\n        this.billingAddress = data;\n      });\n    }\n    else {\n      this.billingAddress.id = null;\n    }\n\n    if (shippingId != null) {\n      this.addressesProvider.getAddress(shippingId).then(data => {\n        this.shippingAddress = data;\n      });\n    }\n    else\n      this.shippingAddress.id = null;\n  }\n\n  changeShippingAddress() {\n    let addressId = null;\n    if (this.shippingAddress.id != null)\n      addressId = this.shippingAddress.id\n    var modalPage = this.modalCtrl.create('AddressPickerPage', {\n      id: addressId\n    });\n\n    modalPage.onDidDismiss((data) => {\n      this.addressesProvider.getAddress(data).then(data => {\n        this.shippingAddress = data;\n      });\n    })\n\n    modalPage.present();\n  }\n\n  changeBillingAddress() {\n    let addressId = null;\n    if (this.billingAddress.id != null)\n      addressId = this.shippingAddress.id\n    var modalPage = this.modalCtrl.create('AddressPickerPage', {\n      id: addressId\n    });\n\n    modalPage.onDidDismiss((data) => {\n      this.addressesProvider.getAddress(data).then(data => {\n        this.billingAddress = data;\n      });\n    })\n\n    modalPage.present();\n  }\n\n  create() {\n    let products = [];\n    this.checkoutList.forEach(item => {\n      products.push(item.product);\n    });\n    let json = {\n      \"id\": null,\n      \"userId\": this.user.id,\n      \"date\": new Date().toString(),\n      \"status\": \"Awaiting Payment\",\n      \"productTotal\": +this.subTotalAmnt,\n      \"shippingTotal\": +this.shippingAmnt,\n      \"orderTotal\": +this.totalAmnt,\n      \"delivery\": this.deliveryOption[this.delivery],\n      \"payment\": this.payment,\n      \"products\": products,\n      \"shippingAddress\": this.shippingAddress,\n      \"billingAddress\": this.billingAddress\n    }\n\n    this.ordersProvider.create(json).then(res => {\n      if (res) {\n        this.checkoutList.forEach(item => {\n          this.cartsProvider.delete(item.id);\n        });\n        this.navCtrl.popToRoot();\n        var modalPage = this.modalCtrl.create('OrderDetailsPage', { data: res });\n        modalPage.present();\n      }\n    })\n  }\n\n  ionViewWillEnter() {\n    if (this.user.id == 0)\n      this.navCtrl.setRoot(\"LoginPage\");\n  }\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/checkout/checkout.ts"],"sourceRoot":""}